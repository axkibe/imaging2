<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>imaging2: imaging::DiffusionStep&lt; fem_types &gt; Class Template Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceimaging.html">imaging</a>::<a class="el" href="classimaging_1_1DiffusionStep.html">DiffusionStep</a>
  </div>
</div>
<div class="contents">
<h1>imaging::DiffusionStep&lt; fem_types &gt; Class Template Reference<br>
<small>
[<a class="el" href="group__fem__equation.html">Equations</a>]</small>
</h1><!-- doxytag: class="imaging::DiffusionStep" --><!-- doxytag: inherits="SimpleEquationInterface&lt; fem_types &gt;" -->Implements an implicit time step of an isotropic diffusion equation.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="DiffusionStep_8hpp-source.html">DiffusionStep.hpp</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for imaging::DiffusionStep&lt; fem_types &gt;:</div>
<div class="dynsection">

<p><center><img src="classimaging_1_1DiffusionStep.png" usemap="#imaging::DiffusionStep< fem_types >_map" border="0" alt=""></center>
<map name="imaging::DiffusionStep< fem_types >_map">
<area href="classimaging_1_1SimpleEquationInterface.html" alt="imaging::SimpleEquationInterface< fem_types >" shape="rect" coords="0,0,277,24">
</map>
</div>

<p>
<a href="classimaging_1_1DiffusionStep-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef <a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__matrix.html">ublas::fixed_matrix</a><br>
&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, <br>
fem_types::data_dimension, <br>
fem_types::data_dimension &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#d59a4af3badb1ac7a30b35052639a3fe">matrix_coefficient_t</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0309fa0dc1eeeb88b5c82f5c954fd549"></a><!-- doxytag: member="imaging::DiffusionStep::vector_coefficient_t" ref="0309fa0dc1eeeb88b5c82f5c954fd549" args="" -->
typedef <a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__vector.html">ublas::fixed_vector</a><br>
&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, <br>
fem_types::data_dimension &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>vector_coefficient_t</b></td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const ublas::vector&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#1cb10e0a6fd1dd5530d2abfdd2dd1719">input</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#5a0f06673ab958136dc173c02aff0fd7">set_input</a> (boost::shared_ptr&lt; ublas::vector&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &gt; &gt; input_ptr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const ublas::vector&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#693693c4ebd3c3264b606477297d7cea">diffusion</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#f9da991dbce9ea0144ce2a17dc8d6c4f">set_diffusion</a> (boost::shared_ptr&lt; ublas::vector&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &gt; &gt; diffusion_ptr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#5ce3bd39e505f3ea0ddcacb23253c8aa">step_size</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#cb97b4d2efa1057e21feb493f01740c3">set_step_size</a> (<a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> step_size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#d084b41bf0666f035dd1ec6240696412">stiffness_matrix</a> (std::size_t integrator_node, const <a class="el" href="classimaging_1_1FemKernel.html">FemKernel</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt; &amp;kernel, <a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__matrix.html">matrix_coefficient_t</a> &amp;A, <a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__vector.html">ublas::fixed_vector</a>&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, fem_types::data_dimension &gt; &amp;a, <a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__vector.html">ublas::fixed_vector</a>&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, fem_types::data_dimension &gt; &amp;b, <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &amp;c) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#e91ce6d65d0d4aee60c47c1acb6d13e2">force_vector</a> (std::size_t integrator_node, const <a class="el" href="classimaging_1_1FemKernel.html">FemKernel</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt; &amp;kernel, <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &amp;f, <a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__vector.html">ublas::fixed_vector</a>&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, fem_types::data_dimension &gt; &amp;g) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#cdfe0ba85d1d65e4d848515c5fb7ec9d">sanity_check_stiffness_matrix</a> (const <a class="el" href="classimaging_1_1FemKernel.html">FemKernel</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt; &amp;kernel, std::string &amp;error_message) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#56a3a04eebe18607339c595fe4a8db00">sanity_check_force_vector</a> (const <a class="el" href="classimaging_1_1FemKernel.html">FemKernel</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt; &amp;kernel, std::string &amp;error_message) const </td></tr>

<tr><td colspan="2"><br><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const <a class="el" href="group__core.html#g9a15696a1ae77dcbdb1f0de8b115c2e6">size_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#4d853fa7c5cadcbe116aeac080dbdac0">boundary_data_type</a> = <a class="el" href="classimaging_1_1SimpleEquationInterface.html">SimpleEquationInterface</a>&lt;<a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a>&gt;::NO_BOUNDARY_DATA</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#ba93c5e8960bf36967241f4b76a06368">a_active</a> = false</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#8e128931e08d4e0486b751f8afd4777b">b_active</a> = false</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#40e6ec3857a37a029acc972e61d524e0">c_active</a> = true</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#9d192abcafa37ddb433dc844df2d5fde">f_active</a> = true</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimaging_1_1DiffusionStep.html#5824f0614e5a918bb44b5d45060bfd98">g_active</a> = false</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;class fem_types&gt;<br>
 class imaging::DiffusionStep&lt; fem_types &gt;</h3>

Implements an implicit time step of an isotropic diffusion equation. 
<p>
This class implements the equation <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{u - u^0}\delta = \nabla \cdot (a \nabla u)\,. \]" src="form_2.png">
<p>
 Here <img class="formulaInl" alt="$u$" src="form_3.png">, <img class="formulaInl" alt="$u^0$" src="form_4.png"> and <img class="formulaInl" alt="$a$" src="form_5.png"> are scalar functions on the problem domain and <img class="formulaInl" alt="$\delta > 0$" src="form_6.png">. The user must provide the initial value <img class="formulaInl" alt="$u^0$" src="form_4.png">, the diffusion <img class="formulaInl" alt="$a$" src="form_5.png"> and the step size <img class="formulaInl" alt="$\delta$" src="form_7.png"> to assemble the system of linear equations which can be solved for <img class="formulaInl" alt="$u$" src="form_3.png">. <hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="d59a4af3badb1ac7a30b35052639a3fe"></a><!-- doxytag: member="imaging::DiffusionStep::matrix_coefficient_t" ref="d59a4af3badb1ac7a30b35052639a3fe" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__matrix.html">ublas::fixed_matrix</a>&lt;<a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, fem_types::data_dimension, fem_types::data_dimension&gt; <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::<a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__matrix.html">matrix_coefficient_t</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Defines the type of matrix as passed to A(). If A() returns a diagonal matrix choosing an appropriate type to store this matrix might yield a speed-up (in particular in higher dimensions; in the plane the difference will most probably neglible). 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#f3a6b7141af8ec8b57f0fcdca8b5dd7c">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="1cb10e0a6fd1dd5530d2abfdd2dd1719"></a><!-- doxytag: member="imaging::DiffusionStep::input" ref="1cb10e0a6fd1dd5530d2abfdd2dd1719" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const ublas::vector&lt;<a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>&gt;&amp; <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::input           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a reference to the vector containing the initial value <img class="formulaInl" alt="$u^0$" src="form_4.png">. 
</div>
</div><p>
<a class="anchor" name="5a0f06673ab958136dc173c02aff0fd7"></a><!-- doxytag: member="imaging::DiffusionStep::set_input" ref="5a0f06673ab958136dc173c02aff0fd7" args="(boost::shared_ptr&lt; ublas::vector&lt; float_t &gt; &gt; input_ptr)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::set_input           </td>
          <td>(</td>
          <td class="paramtype">boost::shared_ptr&lt; ublas::vector&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &gt; &gt;&nbsp;</td>
          <td class="paramname"> <em>input_ptr</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets the vector containing the initial value <img class="formulaInl" alt="$u^0$" src="form_4.png">. 
</div>
</div><p>
<a class="anchor" name="693693c4ebd3c3264b606477297d7cea"></a><!-- doxytag: member="imaging::DiffusionStep::diffusion" ref="693693c4ebd3c3264b606477297d7cea" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const ublas::vector&lt;<a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>&gt;&amp; <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::diffusion           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a reference to the vector containing the diffusion <img class="formulaInl" alt="$a$" src="form_5.png">. 
</div>
</div><p>
<a class="anchor" name="f9da991dbce9ea0144ce2a17dc8d6c4f"></a><!-- doxytag: member="imaging::DiffusionStep::set_diffusion" ref="f9da991dbce9ea0144ce2a17dc8d6c4f" args="(boost::shared_ptr&lt; ublas::vector&lt; float_t &gt; &gt; diffusion_ptr)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::set_diffusion           </td>
          <td>(</td>
          <td class="paramtype">boost::shared_ptr&lt; ublas::vector&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &gt; &gt;&nbsp;</td>
          <td class="paramname"> <em>diffusion_ptr</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets the vector containing the diffusion <img class="formulaInl" alt="$a$" src="form_5.png">. 
</div>
</div><p>
<a class="anchor" name="5ce3bd39e505f3ea0ddcacb23253c8aa"></a><!-- doxytag: member="imaging::DiffusionStep::step_size" ref="5ce3bd39e505f3ea0ddcacb23253c8aa" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::step_size           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the current time step <img class="formulaInl" alt="$\delta$" src="form_7.png">. 
</div>
</div><p>
<a class="anchor" name="cb97b4d2efa1057e21feb493f01740c3"></a><!-- doxytag: member="imaging::DiffusionStep::set_step_size" ref="cb97b4d2efa1057e21feb493f01740c3" args="(float_t step_size)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::set_step_size           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>&nbsp;</td>
          <td class="paramname"> <em>step_size</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets the size of the time step. 
</div>
</div><p>
<a class="anchor" name="d084b41bf0666f035dd1ec6240696412"></a><!-- doxytag: member="imaging::DiffusionStep::stiffness_matrix" ref="d084b41bf0666f035dd1ec6240696412" args="(std::size_t integrator_node, const FemKernel&lt; fem_types &gt; &amp;kernel, matrix_coefficient_t &amp;A, ublas::fixed_vector&lt; float_t, fem_types::data_dimension &gt; &amp;a, ublas::fixed_vector&lt; float_t, fem_types::data_dimension &gt; &amp;b, float_t &amp;c) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::stiffness_matrix           </td>
          <td>(</td>
          <td class="paramtype">std::size_t&nbsp;</td>
          <td class="paramname"> <em>integrator_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classimaging_1_1FemKernel.html">FemKernel</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__matrix.html">matrix_coefficient_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__vector.html">ublas::fixed_vector</a>&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, fem_types::data_dimension &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__vector.html">ublas::fixed_vector</a>&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, fem_types::data_dimension &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>c</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Evaluates <img class="formulaInl" alt="$A$" src="form_57.png">, <img class="formulaInl" alt="$a$" src="form_5.png">, <img class="formulaInl" alt="$b$" src="form_55.png"> and <img class="formulaInl" alt="$c$" src="form_56.png"> in <em>integrator_node</em> on the current element of <em>kernel</em>.<p>
As <em>kernel</em> is set to the current element, in the implementation of this function all relevant values of the shape functions and the element transform can be retrieved from <em>kernel</em> via <em>integrator_node</em>. One can also obtain the FE grid from the kernel (<a class="el" href="classimaging_1_1FemKernel.html#3a0ac5880414db3603a76a358e8d32bd">FemKernel::grid()</a>) and use its interpolation methods (passing the already correctly initialized <em>kernel</em> to them). 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#6a065739c6edef7e9035214abbcdf120">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

<p>References <a class="el" href="FemKernel_8hpp-source.html#l00072">imaging::FemKernel&lt; fem_types &gt;::grid()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e91ce6d65d0d4aee60c47c1acb6d13e2"></a><!-- doxytag: member="imaging::DiffusionStep::force_vector" ref="e91ce6d65d0d4aee60c47c1acb6d13e2" args="(std::size_t integrator_node, const FemKernel&lt; fem_types &gt; &amp;kernel, float_t &amp;f, ublas::fixed_vector&lt; float_t, fem_types::data_dimension &gt; &amp;g) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::force_vector           </td>
          <td>(</td>
          <td class="paramtype">std::size_t&nbsp;</td>
          <td class="paramname"> <em>integrator_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classimaging_1_1FemKernel.html">FemKernel</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classboost_1_1numeric_1_1ublas_1_1fixed__vector.html">ublas::fixed_vector</a>&lt; <a class="el" href="group__core.html#gf2c95632db94ddc193b32e57a1e8e2d9">float_t</a>, fem_types::data_dimension &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>g</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Evaluates <img class="formulaInl" alt="$f$" src="form_22.png"> and <img class="formulaInl" alt="$g$" src="form_31.png"> in <em>integrator_node</em> on the current element of <em>kernel</em>.<p>
As <em>kernel</em> is set to the current element, in the implementation of this function all relevant values of the shape functions and the element transform can be retrieved from <em>kernel</em> via <em>integrator_node</em>. One can also obtain the FE grid from the kernel (<a class="el" href="classimaging_1_1FemKernel.html#3a0ac5880414db3603a76a358e8d32bd">FemKernel::grid()</a>) and use its interpolation methods (passing the already correctly initialized <em>kernel</em> to them). 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#c863bd19a9becb17e0f46e0d1f502d11">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

<p>References <a class="el" href="FemKernel_8hpp-source.html#l00072">imaging::FemKernel&lt; fem_types &gt;::grid()</a>.</p>

</div>
</div><p>
<a class="anchor" name="cdfe0ba85d1d65e4d848515c5fb7ec9d"></a><!-- doxytag: member="imaging::DiffusionStep::sanity_check_stiffness_matrix" ref="cdfe0ba85d1d65e4d848515c5fb7ec9d" args="(const FemKernel&lt; fem_types &gt; &amp;kernel, std::string &amp;error_message) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::sanity_check_stiffness_matrix           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classimaging_1_1FemKernel.html">FemKernel</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>error_message</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if the dimension of the data corresponds to the dimension of the grid stored in <em>kernel</em> for the assembly of the stiffness matrix.<p>
This function is called by the assemble routine right before the assembly of the stiffness matrix. It should return <em>false</em> if data which is necessary for the assembly of the stiffness matrix is still missing. Otherwise, return <em>true</em>; 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#25ce82ef09f07d93e431ae27fcd99e84">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

<p>References <a class="el" href="FemKernel_8hpp-source.html#l00072">imaging::FemKernel&lt; fem_types &gt;::grid()</a>.</p>

</div>
</div><p>
<a class="anchor" name="56a3a04eebe18607339c595fe4a8db00"></a><!-- doxytag: member="imaging::DiffusionStep::sanity_check_force_vector" ref="56a3a04eebe18607339c595fe4a8db00" args="(const FemKernel&lt; fem_types &gt; &amp;kernel, std::string &amp;error_message) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::sanity_check_force_vector           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classimaging_1_1FemKernel.html">FemKernel</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>error_message</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if the dimension of the data corresponds to the dimension of the grid stored in <em>kernel</em> for the assembly of the force vector.<p>
This function is called by the assemble routine right before the assembly of the force vector. It should return <em>false</em> if data which is necessary for the assembly of the force vector is still missing. Otherwise, return <em>true</em>; 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#f8ededab332800a6b6bb38fcf7646987">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

<p>References <a class="el" href="FemKernel_8hpp-source.html#l00072">imaging::FemKernel&lt; fem_types &gt;::grid()</a>.</p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="4d853fa7c5cadcbe116aeac080dbdac0"></a><!-- doxytag: member="imaging::DiffusionStep::boundary_data_type" ref="4d853fa7c5cadcbe116aeac080dbdac0" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__core.html#g9a15696a1ae77dcbdb1f0de8b115c2e6">size_t</a> <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::<a class="el" href="classimaging_1_1DiffusionStep.html#4d853fa7c5cadcbe116aeac080dbdac0">boundary_data_type</a> = <a class="el" href="classimaging_1_1SimpleEquationInterface.html">SimpleEquationInterface</a>&lt;<a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a>&gt;::NO_BOUNDARY_DATA<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The type of boundary conditions for this equation as defined in <a class="el" href="classimaging_1_1SimpleEquationInterface.html#6e98390779c720e47e96df472f98fc4e">SimpleEquationInterface::boundary_data_types</a>. 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#ca9b4a4d0e6ef514597c3e3ba89645ae">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

</div>
</div><p>
<a class="anchor" name="ba93c5e8960bf36967241f4b76a06368"></a><!-- doxytag: member="imaging::DiffusionStep::a_active" ref="ba93c5e8960bf36967241f4b76a06368" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const bool <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::<a class="el" href="classimaging_1_1DiffusionStep.html#ba93c5e8960bf36967241f4b76a06368">a_active</a> = false<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Must be set to <em>true</em> if <img class="formulaInl" alt="$a$" src="form_5.png"> can be non-zero. If it is <em>false</em>, <img class="formulaInl" alt="$a$" src="form_5.png"> will not be evaluated in the assembly functions to save computation time. 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#b53090346b28044add0b4787ac0a746b">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

</div>
</div><p>
<a class="anchor" name="8e128931e08d4e0486b751f8afd4777b"></a><!-- doxytag: member="imaging::DiffusionStep::b_active" ref="8e128931e08d4e0486b751f8afd4777b" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const bool <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::<a class="el" href="classimaging_1_1DiffusionStep.html#8e128931e08d4e0486b751f8afd4777b">b_active</a> = false<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Must be set to <em>true</em> if <img class="formulaInl" alt="$b$" src="form_55.png"> can be non-zero. If it is <em>false</em>, <img class="formulaInl" alt="$b$" src="form_55.png"> will not be evaluated in the assembly functions to save computation time. 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#298b95b7fa2eaaffd68b96ce7805e137">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

</div>
</div><p>
<a class="anchor" name="40e6ec3857a37a029acc972e61d524e0"></a><!-- doxytag: member="imaging::DiffusionStep::c_active" ref="40e6ec3857a37a029acc972e61d524e0" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const bool <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::<a class="el" href="classimaging_1_1DiffusionStep.html#40e6ec3857a37a029acc972e61d524e0">c_active</a> = true<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Must be set to <em>true</em> if <img class="formulaInl" alt="$c$" src="form_56.png"> can be non-zero. If it is <em>false</em>, <img class="formulaInl" alt="$c$" src="form_56.png"> will not be evaluated in the assembly functions to save computation time. 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#667b200b942a4159e1d9b03c6a6e0533">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

</div>
</div><p>
<a class="anchor" name="9d192abcafa37ddb433dc844df2d5fde"></a><!-- doxytag: member="imaging::DiffusionStep::f_active" ref="9d192abcafa37ddb433dc844df2d5fde" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const bool <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::<a class="el" href="classimaging_1_1DiffusionStep.html#9d192abcafa37ddb433dc844df2d5fde">f_active</a> = true<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Must be set to <em>true</em> if <img class="formulaInl" alt="$f$" src="form_22.png"> can be non-zero. If it is <em>false</em>, <img class="formulaInl" alt="$f$" src="form_22.png"> will not be evaluated in the assembly functions to save computation time. 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#377f80a1c17bcd0c3872a0bcebfb87db">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

</div>
</div><p>
<a class="anchor" name="5824f0614e5a918bb44b5d45060bfd98"></a><!-- doxytag: member="imaging::DiffusionStep::g_active" ref="5824f0614e5a918bb44b5d45060bfd98" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class fem_types&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const bool <a class="el" href="classimaging_1_1DiffusionStep.html">imaging::DiffusionStep</a>&lt; <a class="el" href="classimaging_1_1SimpleEquationInterface.html#2da4f294db17ec7fbe5cb0bcb61f9486">fem_types</a> &gt;::<a class="el" href="classimaging_1_1DiffusionStep.html#5824f0614e5a918bb44b5d45060bfd98">g_active</a> = false<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Must be set to <em>true</em> if <img class="formulaInl" alt="$g$" src="form_31.png"> can be non-zero. If it is <em>false</em>, <img class="formulaInl" alt="$g$" src="form_31.png"> will not be evaluated in the assembly functions to save computation time. 
<p>Reimplemented from <a class="el" href="classimaging_1_1SimpleEquationInterface.html#eca56c9c50243ac02c0c49bcdc5def02">imaging::SimpleEquationInterface&lt; fem_types &gt;</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>imaging2/fem/equation/<a class="el" href="DiffusionStep_8hpp-source.html">DiffusionStep.hpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Feb 10 10:01:31 2009 for imaging2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
